<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Recurrent Glimpse-based Decoder for Detection with Transformer | Daekyung Kim</title> <meta name="author" content="Daekyung Kim"/> <meta name="description" content="the Region-of-Interest (RoI) based detection refinement can easily help mitigate the difficulty of training for DETR methods"/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ“Ÿ</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://dkdkkim.github.io/blog/2022/rego/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://dkdkkim.github.io/"><span class="font-weight-bold">Daekyung</span> Kim</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/projects/">projects</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Recurrent Glimpse-based Decoder for Detection with Transformer</h1> <p class="post-meta">August 9, 2022</p> <p class="post-tags"> <a href="/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a> Â  Â· Â  <a href="/blog/tag/review"> <i class="fas fa-hashtag fa-sm"></i> review</a> Â  Â  Â· Â  <a href="/blog/category/paper-review"> <i class="fas fa-tag fa-sm"></i> paper-review</a> Â  </p> </header> <article class="post-content"> <p>ìµœê·¼ Image recognitionì˜ ì—¬ëŸ¬ê°€ì§€ ë¶„ì•¼ì—ì„œ Vision TransformerëŠ” ë§ì€ ì„±ê³¼ë¥¼ ì´ë£¨ì–´ëƒˆë‹¤. Object detection ë¶„ì•¼ì—ì„œë„ ê·¸ íŠ¸ë Œë“œëŠ” ë‹¤ë¥´ì§€ ì•Šì•˜ëŠ”ë° ê·¸ ëŒ€í‘œì ì¸ì˜ˆê°€ <a href="https://arxiv.org/abs/2005.12872" target="_blank" rel="noopener noreferrer">DETR(Detection with Transformer)</a> ë¼ê³  í•  ìˆ˜ ìˆë‹¤. ë‹¤ë§Œ Vision Transformerì˜ ê²½ìš° CNN ì— ë¹„í•´ì„œ ìƒëŒ€ì ìœ¼ë¡œ ë§ì€ ë°ì´í„°ë¡œ ì˜¤ë«ë™ì•ˆ íŠ¸ë ˆì´ë‹í•´ì•¼ í•œë‹¤ëŠ” í•œê³„ì ì„ ê°€ì§€ê³  ìˆë‹¤. ì´ëŸ° ë‹¨ì ì„ ê·¹ë³µí•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ê°€ì§€ ì ‘ê·¼ë“¤ì´ ìˆì—ˆëŠ”ë° ì´ë²ˆì— ì†Œê°œí•  ë…¼ë¬¸ë„ ê·¸ëŸ° ì ‘ê·¼ë“¤ ì¤‘ì— í•˜ë‚˜ì´ë‹¤.</p> <hr> <h2 id="problem"><strong>Problem</strong></h2> <p>ì•ì—ì„œ ë§í–ˆë‹¤ì‹œí”¼ DETRì˜ íš¨ê³¼ëŠ” ì—¬ëŸ¬ ì—°êµ¬ë¥¼ í†µí•´ì„œ ê²€ì¦ì´ ë˜ì—ˆê³  ê·¸ ì—°êµ¬ëŠ” ì ì  ëŠ˜ì–´ê°€ê³  ìˆë‹¤. í•˜ì§€ë§Œ DETRì€ ì¼ì • ìˆ˜ì¤€ì´ìƒì˜ ê²€ì¶œì„±ëŠ¥ì„ í•™ìŠµí•˜ê¸°ê¹Œì§€ ì•„ì£¼ ì˜¤ëœì‹œê°„ì„ ìš”êµ¬í•œë‹¤. MS COCO datasetì˜ ê²½ìš°ë¥¼ ì˜ˆë¡œ ë“¤ìë©´, <a href="https://arxiv.org/abs/1612.03144" target="_blank" rel="noopener noreferrer">Feature Pyramid Network(FPN)</a>ì˜ ê²½ìš°ì—ëŠ” 36 epoch ì •ë„ë©´ ë˜ëŠ” ì„±ëŠ¥ê¹Œì§€ í•™ìŠµë˜ëŠ”ë°ì— <strong>500 epoch</strong> ì •ë„ê°€ ì†Œìš”ëœë‹¤. V100ì´ë¼ëŠ” ë†’ì€ ì„±ëŠ¥ì˜ GPU 8ê°œë¥¼ ì‚¬ìš©í•´ë„ 10ì¼ ì´ìƒì´ ê±¸ë¦¬ëŠ” ìˆ˜ì¤€ì´ê¸° ë•Œë¬¸ì— ì‹¤ì§ˆì ìœ¼ë¡œ ëª¨ë¸ì„ í•™ìŠµí•˜ê³  ì‚¬ìš©í•˜ëŠ”ë°ì— ì–´ë ¤ì›€ì´ ìˆì„ ìˆ˜ ë°–ì— ì—†ë‹¤.</p> <hr> <h2 id="approach"><strong>Approach</strong></h2> <p>ë³¸ ë…¼ë¬¸ì—ì„œëŠ” REcurrent Glimpse-based decOder(REGO)ë¼ëŠ” ëª¨ë¸ì„ ì œì•ˆí•˜ê³  ìˆë‹¤. ì´ ëª¨ë¸ì€ ì´ì „ì˜ ë‹¤ë¥¸ ì ‘ê·¼ë“¤ê³¼ëŠ” ë‹¤ë¥¸ê²Œ RoIì— ì§‘ì¤‘í•˜ì—¬ detectionì„ refinement í•  ê²½ìš° DETRì˜ í•™ìŠµì˜ ì–´ë ¤ì›€ì„ ë¹„êµì  ì‰½ê²Œ ê°œì„ í•œë‹¤. ì´ì „ì˜ ì ‘ê·¼ë“¤ì€ feature ë‹¨ì´ë‚˜ embedding ë¶€ë¶„ë“¤ì„ í†µí•´ì„œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³ ìí•˜ëŠ” ë°©ë²•ë¡ ë“¤ì´ ëŒ€ë¶€ë¶„ì´ì—ˆë‹¤.</p> <div> <center><img src="../../../assets/img/rego01.png" alt="rego_approach" width="60%" height="60%"></center> </div> <div class="caption"> <center>Concept of REcurrent glimpse-based decoder (REGO)</center> </div> <hr> <h2 id="method"><strong>Method</strong></h2> <p>REGO modelì˜ ì „ì²´ì ì¸ workflowëŠ” DETRì˜ ì¶œë ¥ë¬¼ì¸ \(O_{box}\)ì™€ feature \(H_{dec}\)ì„ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ \(N\)ê°œì˜ stepì˜ ë°˜ë³µì„ í†µí•´ì„œ ìµœì¢…ì ì¸ predictionì„ í•˜ê²Œ ë˜ë©°, ê°ê°ì˜ stepì€ Glimpse-based Decoderë¡œ êµ¬ì„±ë˜ì–´ìˆë‹¤.</p> <div> <center><img src="../../../assets/img/rego02.png" alt="rego_method" width="70%" height="70%"></center> </div> <div class="caption"> <center>The overview of the REGO</center> </div> <h3 id="glimpse-based-decoder">Glimpse-based Decoder</h3> <p>DETRì˜ output ë˜ëŠ” ì´ì „ blockì˜ ì¶œë ¥ê°’ì¤‘ \(O_{box}(i-1)\)ì„ ì´ìš©í•˜ì—¬ í•´ë‹¹ì˜ì—­ì—ì„œ featureë¥¼ ì¶”ì¶œí•˜ê²Œ ëœë‹¤. ì´ë•Œì— box ê°’ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ marginì„ ê°–ê³  ì¡°ê¸ˆë” ë„“ì€ ì˜ì—­ì—ì„œ featureë¥¼ ì¶”ì¶œí•˜ëŠ”ë° Diagramì—ì„œ Enlargeë¼ê³  í‘œì‹œëœ ë¶€ë¶„ì´ë‹¤. ì´ë•Œ enlarge í•˜ëŠ” ë¹„ìœ¨ì„ ë‚˜íƒ€ë‚´ëŠ” glimpse scale \(\alpha\) ëŠ” ì ì  ê°ì†Œí•˜ê²Œ ë˜ëŠ”ë° 3stepì¼ ê²½ìš°ë¥¼ ì˜ˆë¡œ ë“¤ë©´ \(\alpha=3,2,1\) ì´ëœë‹¤.</p> <div> <center><img src="../../../assets/img/rego03.png" alt="rego_method" width="30%" height="30%"></center> </div> <div class="caption"> <center>Enlarge step of Glimpse-based Decoder</center> </div> <p>ì´ë ‡ê²Œ í•´ë‹¹ RoIì—ì„œ ì¶”ì¶œëœ feature \(V(i)\)ëŠ” query ê°’ì´ ë˜ê³  ì´ì „ blockìœ¼ë¡œ ë¶€í„°ì˜ feature \(Hec(i-1)\) ì€ Linear Projectionìœ¼ë¡œ dimension ì¡°ì • í›„ key, value ê°’ì´ ë˜ì–´ Multi-head cross attention í›„ \(H_{g}(i)\) ê°€ ëœë‹¤. \(H_{g}(i)\) ì™€ \(Hec(i-1)\)ë¥¼ concatenationì„ í†µí•´ í•˜ë‚˜ì˜ featureë¡œ ë§Œë“¤ê³  MLPë¥¼ í†µí•´ì„œ ìƒˆë¡œìš´ Detected Boxes \(O_{box}(i)\), Classification Output \(O_{cls}(i)\) ê·¸ë¦¬ê³  Decoding Output \(H_{dec}(i)\) ë¥¼ ì¶œë ¥í•˜ê²Œ ëœë‹¤.</p> <h3 id="multi-stage-reccurent-processing">Multi-stage Reccurent Processing</h3> <p>ì´ëŸ° glimpes-based Decoderë¥¼ $N$ë²ˆ ë°˜ë³µí•˜ì—¬ ReGO model ì´ ì™„ì„±ë˜ë©° ì¤‘ê°„ê³¼ì •ì—ì„œëŠ” boxì™€ feature ë§Œ ì‚¬ìš©ë˜ì§€ë§Œ ë§ˆì§€ë§‰ ë¸”ëŸ­ì—ì„œëŠ” classification ê°’ê¹Œì§€ ìµœì¢… ì˜ˆì¸¡ê°’ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤. ë³¸ë…¼ë¬¸ì—ì„œ ì¼ë°˜ì ìœ¼ë¡œ stepì˜ ìˆ˜ $N$ì€ 3ì„ ì‚¬ìš©í•˜ì˜€ìœ¼ë©°, ì´ëŠ” ì‹¤í—˜ì ìœ¼ë¡œ ì„ íƒëœ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/rego04-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/rego04-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/rego04-1400.webp"></source> <img src="/assets/img/rego04.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/rego05-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/rego05-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/rego05-1400.webp"></source> <img src="/assets/img/rego05.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Hyper-parameter study of the number of stages in REGO and the glimpse scale in REGO </div> <hr> <h2 id="experimental-result"><strong>Experimental result</strong></h2> <p>MS COCO validation splitì—ì„œ 35, 50 epochì—ì„œì˜ ê²°ê³¼ë¥¼ ì•„ë˜ì™€ ê°™ì´ ì—¬ëŸ¬ê°€ì§€ existing Object Detection ëª¨ë¸ë“¤ê³¼ ë¹„êµí–ˆìœ¼ë©°, ê´€ì‹¬ì„ ê°€ì§€ê³  ë³´ì•„ì•¼í•  ë¶€ë¶„ì€ ì¼ë°˜ì ì¸ DETRê³¼ ì•ì„œ Training ë¬¸ì œë¥¼ ê°œì„ í•œ <a href="https://arxiv.org/abs/2010.04159" target="_blank" rel="noopener noreferrer">Deformable DETR</a> ê³¼ì˜ ë¹„êµì´ë‹¤.</p> <div> <center><img src="../../../assets/img/rego06.png" alt="rego_method" width="60%" height="60%"></center> </div> <div class="caption"> <center>Results of different detectors on the MS COCO val split</center> </div> <p>í‘œì—ì„œ ë³´ë©´ ì•Œ ìˆ˜ ìˆë“¯ì´ DETR ì€ ë¬¼ë¡ ì´ë„ Deformable DETR ë³´ë‹¤ë„ ë™ì¼ epochì„ training í–ˆì„ ë•Œ ë†’ì€ ì„±ëŠ¥ì„ ë³´ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤. ì‹¬ì§€ì–´ ë™ì¼í•œ ResNet 50 backbone ê¸°ì¤€ìœ¼ë¡œ ë³´ì•˜ì„ ë•Œì— REGOë¡œ 36 epochì„ training í–ˆì„ ë•Œ ì„±ëŠ¥(44.8)ì´ Deformable DETR ì˜ ì„±ëŠ¥(43.8) ë³´ë‹¤ ë†’ì€ ê²ƒê¹Œì§€ë„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p> <hr> <h2 id="limitations"><strong>Limitations</strong></h2> <p>ë³¸ ë…¼ë¬¸ì—ì„œ ì €ìë„ ì–¸ê¸‰í–ˆì§€ë§Œ, REGOë¥¼ í†µí•´ì„œ DETRì˜ í•™ìŠµ íš¨ìœ¨ì€ ë§ì´ ê°œì„ ë˜ì—ˆì§€ë§Œ ì—¬ì „íˆ training í•˜ëŠ”ë°ì— ìˆ˜ ì¼ì´ ì†Œìš”ë˜ê¸° ë•Œë¬¸ì— ì•ìœ¼ë¡œë„ ê°œì„ ì˜ ì—¬ì§€ëŠ” ë‚¨ì•„ìˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  ê°œì¸ì ìœ¼ë¡œëŠ” ë³¸ ë…¼ë¬¸ì—ì„œ ì„±ëŠ¥ ê²€ì¦ì— ì‚¬ìš©ëœ ì§€í‘œëŠ” validation splitì˜ ê²°ê³¼ì—¬ì„œ test splitì—ì„œì˜ ì„±ëŠ¥ì˜ ê²€ì¦ì´ í•„ìš”í•˜ê³ , 50 epochì´ìƒ training í•˜ì—¬ ìµœì¢…ì ìœ¼ë¡œ optimized ëœ ì„±ëŠ¥ì˜ ë¹„êµë„ í™•ì¸í•  í•„ìš”ê°€ ìˆë‹¤ê³  ìƒê°í•œë‹¤.</p> <hr> <h2 id="reference">Reference</h2> <ul> <li><a href="https://openaccess.thecvf.com/content/CVPR2022/html/Chen_Recurrent_Glimpse-Based_Decoder_for_Detection_With_Transformer_CVPR_2022_paper.html" target="_blank" rel="noopener noreferrer">Chen, Zhe, Jing Zhang, and Dacheng Tao. â€œRecurrent glimpse-based decoder for detection with transformer.â€ Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. 2022.</a></li> <li><a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjMmPaL3tz5AhVIQt4KHf0tBMUQFnoECAkQAQ&amp;url=https%3A%2F%2Farxiv.org%2Fabs%2F2005.12872&amp;usg=AOvVaw1fNz92-EEj1d91Nfiv875y" target="_blank" rel="noopener noreferrer">Carion, Nicolas, et al. â€œEnd-to-end object detection with transformers.â€ European conference on computer vision. Springer, Cham, 2020.</a></li> <li><a href="https://arxiv.org/abs/2010.04159" target="_blank" rel="noopener noreferrer">Zhu, Xizhou, et al. â€œDeformable detr: Deformable transformers for end-to-end object detection.â€ arXiv preprint arXiv:2010.04159 (2020).</a></li> </ul> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> Â© Copyright 2023 Daekyung Kim. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>. Last updated: April 15, 2023. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>